<!DOCTYPE html><html>
        <head>
        <title>WCM2021</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700,900" rel="stylesheet">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/icomoon/style.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/magnific-popup.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/jquery-ui.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.carousel.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.theme.default.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap-datepicker.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/flaticon/font/flaticon.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/aos.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/style.css">
        <link rel="shortcut icon" href="./../cmsimde/static/favicons.png">
        
        <style type='text/css'>
            .site-section {
            background-color: #FFFF;
            padding: 40px 40px;
            }
            body > div > div.dropdown.open {
                display: block;
            }
        </style>
    
        <!-- <script src="./../cmsimde/static/jquery.js"></script> -->
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
        <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/normalize.min.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch_set.js"></script>
        <script src="tipuesearch_content.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/tipuesearch.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch.js"></script>
        <script>
            /* original tipuesearch
            $(document).ready(function() {
                 $('#tipue_search_input').tipuesearch();
            });
            */
            // customed doSearch
            function doSearch() {
                $('#tipue_search_input').tipuesearch({
                    newWindow: true, 
                    minimumLength: 2,
                    wholeWords: false, // for search 中文
                });
            }
            $(document).ready(doSearch);
        </script>
        
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shCore.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushBash.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDiff.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJScript.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJava.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPython.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushSql.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushHaxe.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushXml.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPhp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushLua.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCss.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCSharp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDart.js"></script>
<link type="text/css" rel="stylesheet" href="./../cmsimde/static/syntaxhighlighter/css/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>
<!-- 暫時不用
<script src="./../cmsimde/static/fengari-web.js"></script>
<script type="text/javascript" src="./../cmsimde/static/Cango-13v08-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/CangoAxes-4v01-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/gearUtils-05.js"></script>
-->
<!-- for Brython 暫時不用
<script src="https://scrum-3.github.io/web/brython/brython.js"></script>
<script src="https://scrum-3.github.io/web/brython/brython_stdlib.js"></script>
-->
<style>
img.add_border {
    border: 3px solid blue;
}
</style>

</head>
<body>
<div class='container'><nav>
        
    <div class="site-wrap">

    <div class="site-mobile-menu">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>
    
            <header class="site-navbar py-4 bg-white" role="banner">
              <div class="container-fluid">
                <div class="row align-items-center">
                <h1>WCM2021 網際內容管理</h1>
                <div class="pl-4">
                    <form>
                    <input type="text" placeholder="Search" name="q" id="tipue_search_input" pattern=".{2,}" title="At least 2 characters" required>
                    </form>
                </div>
                  <!-- <div class="col-11 col-xl-2">
                    <h1 class="mb-0 site-logo"><a href="index.html" class="text-black h2 mb-0">WCM2021 網際內容管理</a></h1> 
                  </div>
                  -->
                  <div class="col-12 col-md-10 d-none d-xl-block">
                    <nav class="site-navigation position-relative text-right" role="navigation">
    <ul class='site-menu js-clone-nav mr-auto d-none d-lg-block'>
                        <li class="active has-children"><a href="index.html">Home</a>
                        <ul class="dropdown">
                            <li><a href="sitemap.html">Site Map</a></li>
                            <li><a href="./../reveal/index.html">reveal</a></li>
                            <li><a href="./../blog/index.html">blog</a></li>
                        </ul>
                      </li>
                     <li class='has-children'><a href='About.html'>About</a><ul class='dropdown'><li><a href='三道牆理論.html'>三道牆理論</a><li><a href='機械工程師.html'>機械工程師</a><li><a href='Programming.html'>Programming</a><li><a href='Heroku.html'>Heroku</a></li></ul><li class='has-children'><a href='Topics.html'>Topics</a><ul class='dropdown'><li class='has-children'><a href='W1-W2.html'>W1-W2</a><ul class='dropdown'><li><a href='網頁除錯.html'>網頁除錯</a></li></ul><li class='has-children'><a href='W4.html'>W4</a><ul class='dropdown'><li><a href='W4 教學.html'>W4 教學</a></li></ul><li class='has-children'><a href='W5.html'>W5</a><ul class='dropdown'><li><a href='W5 教學影片.html'>W5 教學影片</a><li><a href='創新教育.html'>創新教育</a><li><a href='網際程式開發.html'>網際程式開發</a><li><a href='開放教科書.html'>開放教科書</a></li></ul><li class='has-children'><a href='W6.html'>W6</a><ul class='dropdown'><li><a href='Heroku-實作.html'>Heroku-實作</a></li></ul><li><a href='W7.html'>W7</a><li class='has-children'><a href='RoboDK.html'>RoboDK</a><ul class='dropdown'><li><a href='Robotics.html'>Robotics</a></li></ul><li><a href='分組專題.html'>分組專題</a><li><a href='Topic 0.html'>Topic 0</a><li><a href='Topic 1.html'>Topic 1</a><li><a href='輔助工具.html'>輔助工具</a></li></ul><li><a href='WSL.html'>WSL</a><li class='has-children'><a href='Projects.html'>Projects</a><ul class='dropdown'><li><a href='Delta Printer.html'>Delta Printer</a><li><a href='CMSiMDE.html'>CMSiMDE</a><li><a href='Fossil scm.html'>Fossil scm</a><li><a href='CDiMDE.html'>CDiMDE</a><li><a href='Discourse.html'>Discourse</a></li>
                      </ul>
                </nav>
              </div>
              <div class="d-inline-block d-xl-none ml-md-0 mr-auto py-3" style="position: relative; top: 3px;"><a href="#" class="site-menu-toggle js-menu-toggle text-black"><span class="icon-menu h3"></span></a></div>
              </div>

            </div>
          </div>
          
        </header>
    <div id="tipue_search_content">分組專題 << <a href='分組專題.html'>Previous</a> <a href='Topic 1.html'>Next</a> >> Topic 1<br /><h1>Topic 0</h1>
<h4>網際內容管理程式練習題目:</h4>
<ol>
<li>學習如何解讀帶有 <a href="https://en.wikipedia.org/wiki/Ajax_(programming)">AJAX</a> 程式架構的網際伺服器內容</li>
<li>學習如何利用 Python <a href="https://requests.readthedocs.io/en/master/">requests</a> 中的 post 方法, 向伺服器送出表單資料</li>
<li>學習如何利用 <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/">bs4</a> 解讀 <a href="https://developer.mozilla.org/zh-TW/docs/Learn/Getting_started_with_the_web/HTML_basics">HTML</a> 檔案</li>
<li>學習如何利用 Python 程式執行操作系統指令 (<a href="https://docs.python.org/3/library/os.html">os Module</a>)</li>
<li>學習如何將網際程式伺服至 <a href="https://www.heroku.com/">Heroku</a> 雲端主機</li>
</ol>
<p>2021 Spring 的網際內容管理課程將從學校的課程主機中擷取資料開始:</p>
<p>學校的課程相關主機為: <a href="https://qry.nfu.edu.tw/">https://qry.nfu.edu.tw/</a></p>
<p>其中包括</p>
<p style="padding-left: 30px;">查詢各班課表用: <a href="https://qry.nfu.edu.tw/class.php">https://qry.nfu.edu.tw/class.php</a></p>
<p style="padding-left: 30px;">查詢教師課表: <a href="https://qry.nfu.edu.tw/teacher.php">https://qry.nfu.edu.tw/teacher.php</a></p>
<p style="padding-left: 30px;">查詢教室課表: <a href="https://qry.nfu.edu.tw/classroom.php">https://qry.nfu.edu.tw/classroom.php</a></p>
<p style="padding-left: 30px;">查詢課程: <a href="https://qry.nfu.edu.tw/classname.php">https://qry.nfu.edu.tw/classname.php</a></p>
<p style="padding-left: 30px;">查詢班級名條: <a href="https://qry.nfu.edu.tw/classlist.php">https://qry.nfu.edu.tw/classlist.php</a></p>
<p>而與學校排課相關的專案.</p>
<p style="padding-left: 30px;"><a href="https://github.com/mdecourse/GeneticAlgorithmUniversityClassScheduler">https://github.com/mdecourse/GeneticAlgorithmUniversityClassScheduler</a></p>
<p style="padding-left: 60px;"><a href="./../downloads/2018_UNIVERSITY TIMETABLE SCHEDULING USING METAHEURISTIC ADAPTIVE-ELITIST GENETIC ALGORITHM.pdf">2018_UNIVERSITY TIMETABLE SCHEDULING USING METAHEURISTIC ADAPTIVE-ELITIST GENETIC ALGORITHM.pdf</a></p>
<p style="padding-left: 60px;"><a href="https://link.springer.com/book/10.1007/978-1-4842-5857-6">Beginning PyQt - 2020 ebook.pdf</a></p>
<p>以下則為可用來擷取課程主機的參考程式碼:</p>
<p><a href="https://qry.nfu.edu.tw/class.php">class.php</a> 網頁原始碼中 AJAX 程式段:</p>
<p><img alt="" class="add_border" height="604" src="./../images/class.php_ajax_script.png" width="600"/></p>
<p>在 class.php 頁面以表單選擇四技設一甲後進行查詢, 所得超文件中, 以<span style="background-color: #ccffcc;">網頁開發者</span>中的<span style="background-color: #ccffcc;">檢測器</span>可以查得所傳回的 table class 名稱為 tbcls:</p>
<p><img alt="" class="add_border" height="404" src="./../images/class.php_return_table_class_name_tbcls.png" width="600"/></p>
<p>取得四技設一甲 2021 Spring 班級課表, 存為 html 後以內定瀏覽器開啟:</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">import requests
import bs4
# for os.environ and os.system()
import os
# for geting html file path
import pathlib

# for pythn 3.9
proxy = 'http://[2001:288:6004:17::69]:3128'

os.environ['http_proxy'] = proxy 
os.environ['HTTP_PROXY'] = proxy
os.environ['https_proxy'] = proxy
os.environ['HTTPS_PROXY'] = proxy

'''
url:  'class_ajax.php',
data: { pselyr: pselyr, pselclss: pselclss
'''
semester = '1092'
classno = '42311'
column = True

if semester == None:
    semester = '1091'
if classno == None:
    # 42311 is 設一甲
    classno = '42311'
    
headers = {'X-Requested-With': 'XMLHttpRequest'}

url = 'https://qry.nfu.edu.tw/class_ajax.php'
post_var = {'pselyr': semester, 'pselclss': classno}

result = requests.post(url, data = post_var, headers = headers)

soup = bs4.BeautifulSoup(result.content, 'lxml')

# 先除掉所有 anchor
for a in soup.findAll('a'):
    # bs3 語法
    #a.replaceWithChildren()
    # bs4 語法, 將標註與內容拆開
    a.unwrap()

# 根據輸出設定, 取出 class='tbcls' 的 table 資料
table = soup.find('table', {'class': 'tbcls'})

# 重建 table, 設定邊線為 1 pixel
output = "&lt;table border='1'&gt;"

for i in table.contents:
    # 利用 replace 復原  
    output += str(i).replace("&amp;amp;nbsp", " ")
output += "&lt;/table&gt;"
# print(output)
# 將 output 寫入 w1_class_local.html
with open("w1_class_local.html", "w", encoding="utf-8") as file:
    file.write(output)
# 利用 os.system() 以 default browser 開啟 w1_class_local.html
filePath = pathlib.Path(__file__).parent.absolute()
#print(filePath)
# set firefox as default browser and start url to open html file
os.system("start file:///" + str(filePath) + "\\w1_class_local.html")
</pre>
<p><a href="https://drive.google.com/drive/folders/1aIPm_u2RNKk-xVRdhHDqHokjLWHFLAsk">2021 Spring GDrive 下載區</a> (for @gm users only)</p>
<p><a href="https://drive.google.com/file/d/1oJPgppmLSQtx0SDrs4QKOs_YgWDDv2fj/view?usp=sharing">kmol2021_spring_v1</a> 只安裝 Python 3.9, Git, Putty, ShareX 與 processexplorer</p>
<p><a href="https://drive.google.com/file/d/1R6vAAWdNDigmyvFFQTKyM-XNKOWeCFJU/view?usp=sharing">kmol2021_spring_v2</a> 則安裝 Python 3.9, Git, Putty, ShareX 與 processexplorer 外, Python 又加裝 flask, flask_cors, bs4, lxml, pelican, markdown, leo</p>
<p>升級可攜隨身程式系統與其他工具的主要目的, 在確保先前的使用模式與所開發的程式碼, 可以在最新的環境中執行.</p>
<p>但是目前 Python 3.9 仍<a href="https://github.com/tensorflow/tensorflow/issues/44485">無法</a>執行 Tensorflow 2.0, 因此若需使用 Tensorflow 2.0 必須退回 Python 3.8.5 環境.</p>
<h4>主題:</h4>
<p style="padding-left: 30px;"><a href="https://github.com/mdecourse/nfulist/discussions/2">https://github.com/mdecourse/nfulist/discussions/2</a></p>
<p>根據 <a href="https://qry.nfu.edu.tw/class.php">https://qry.nfu.edu.tw/class.php</a></p>
<p>班級課表查詢程式:</p>
<p><a href="https://github.com/mdecourse/wcm2021/blob/main/downloads/w1_class_local.py">w1_class_local.py</a></p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">&lt;script type="text/javascript"&gt;
$(function(){
	$("#bt_qry").click(function(){
	pselyr=$("#selyr").val();
	pselclss=$('#selclss').val();
		if(pselyr.length!=1 &amp;&amp; pselclss.length!=1)
		{
			$.blockUI({
				message: $('&lt;div id="loading" style="display: none;"&gt;處理中...&lt;/div&gt;'),
				css: {
						border: 'none',
						padding: '10px',
						'font-size': '16px'
				}
			});
			$.ajax({
				type: "POST", //post,get
				dataType: "html",
				cache: false, //關閉ajax緩衝區
				url:  'class_ajax.php',
				data: { pselyr: pselyr, pselclss: pselclss },
				success: function(response){
					$("#div_output").html(response);
					//alert(response);
					//$("#myParentSelect").trigger('change');
				$.unblockUI();
				}
			})
		}else{
			alert("請選擇學年/學期或班級代號！");
		}
	});
});
&lt;/script&gt;</pre>
<p>選單參數與對應值</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">selyr

&lt;option value="1092" selected&gt;109學年度第2學期&lt;/option&gt;
&lt;option value="1091" &gt;109學年度第1學期&lt;/option&gt;
&lt;option value="1083" &gt;108學年度第3學期&lt;/option&gt;
&lt;option value="1082" &gt;108學年度第2學期&lt;/option&gt;

selclss

&lt;option value="42310" &gt;42310四設計一訓&lt;/option&gt;
&lt;option value="42311" &gt;42311四設計一甲&lt;/option&gt;
&lt;option value="42312" &gt;42312四設計一乙&lt;/option&gt;
&lt;option value="42319" &gt;42319四設計一攜&lt;/option&gt;
&lt;option value="42320" &gt;42320四設計二訓&lt;/option&gt;
&lt;option value="42321" &gt;42321四設計二甲&lt;/option&gt;
&lt;option value="42322" &gt;42322四設計二乙&lt;/option&gt;
&lt;option value="42329" &gt;42329四設計二攜&lt;/option&gt;
&lt;option value="42330" &gt;42330四設計三訓&lt;/option&gt;
&lt;option value="42331" &gt;42331四設計三甲&lt;/option&gt;
&lt;option value="42332" &gt;42332四設計三乙&lt;/option&gt;
&lt;option value="42339" &gt;42339四設計三攜&lt;/option&gt;
&lt;option value="42340" &gt;42340四設計四訓&lt;/option&gt;
&lt;option value="42341" &gt;42341四設計四甲&lt;/option&gt;
&lt;option value="42342" &gt;42342四設計四乙&lt;/option&gt;
&lt;option value="42349" &gt;42349四設計四攜&lt;/option&gt;</pre>
<p>ajax 透過 post 送出對應變數值</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">url:  'class_ajax.php',
data: { pselyr: pselyr, pselclss: pselclss },</pre>
<p>利用 Python requests 以 post 送出查詢變數後取回查詢結果:</p>
<p>以下為綜一館八樓電腦輔助設計室 2021 Spring 排課表, 程式取回資料後存為 html 後以內定的瀏覽器開啟:</p>
<p><a href="https://github.com/mdecourse/wcm2021/blob/main/downloads/w1_classroom_local.py">w1_classroom_local.py</a></p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">import requests
import bs4
# for os.environ and os.system
import os
# for geting html file path
import pathlib

# for pythn 3.9
proxy = 'http://[2001:288:6004:17::69]:3128'

os.environ['http_proxy'] = proxy 
os.environ['HTTP_PROXY'] = proxy
os.environ['https_proxy'] = proxy
os.environ['HTTPS_PROXY'] = proxy

'''
url:  'jclassroom_ajax.php',
data: { pselyr: pselyr, pselclssroom: pselclssroom },
'''
semester = '1092'
classroomno = 'BGA0810'
column = True

if semester == None:
    semester = '1092'
if classroomno == None:
    # BGA0810 電腦輔助設計室
    classroomno = 'BGA0810'
    
headers = {'X-Requested-With': 'XMLHttpRequest'}

url = 'https://qry.nfu.edu.tw/jclassroom_ajax.php'
post_var = {'pselyr': semester, 'pselclssroom': classroomno}

result = requests.post(url, data = post_var, headers = headers)

soup = bs4.BeautifulSoup(result.content, 'lxml')

# 先除掉所有 anchor
for a in soup.findAll('a'):
    # bs3 語法
    #a.replaceWithChildren()
    # bs4 語法, 將標註與內容拆開
    a.unwrap()

# 根據輸出設定, 取出 class='tbcls' 的 table 資料
table = soup.find('table', {'class': 'tbcls'})

# 重建 table, 設定邊線為 1 pixel
output = "&lt;table border='1'&gt;"

for i in table.contents:
    # 利用 replace 復原  
    output += str(i).replace("&amp;amp;nbsp", " ")
output += "&lt;/table&gt;"
#print(output)

# 將 output 寫入 w1_classroom.html
fileName = "w1_classroom.html"
with open(fileName, "w", encoding="utf-8") as file:
    file.write(output)
# 利用 os.system() 以 default browser 開啟 w1_class_local.html
filePath = pathlib.Path(__file__).parent.absolute()
#print(filePath)
# set firefox as default browser and start url to open html file
os.system("start file:///" + str(filePath) + "\\" + fileName)

</pre>
<p>若根據 <a href="https://qry.nfu.edu.tw/jclassroom.php">https://qry.nfu.edu.tw/jclassroom.php</a></p>
<p>與</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">&lt;option value="BGA0611" &gt;BGA0611 (研討室(三)_綜合工程一館 6F)&lt;/option&gt;
&lt;option value="BGA0620" &gt;BGA0620 (動態系統實驗室_綜合工程一館 6F)&lt;/option&gt;
&lt;option value="BGA0640" &gt;BGA0640 (創意設計室_綜合工程一館 6F)&lt;/option&gt;
&lt;option value="BGA0710" &gt;BGA0710 (研討室(二)_綜合工程一館 7F)&lt;/option&gt;
&lt;option value="BGA0730" &gt;BGA0730 (研討室(一)_綜合工程一館 7F)&lt;/option&gt;
&lt;option value="BGA0760" &gt;BGA0760 (逆向快速成型實驗室_綜合工程一館 7F)&lt;/option&gt;
&lt;option value="BGA0810" &gt;BGA0810 (電腦輔助設計室_綜合工程一館 8F)&lt;/option&gt;
&lt;option value="BGA0820" &gt;BGA0820 (智慧感測與致動實驗室_綜合工程一館 8F)&lt;/option&gt;
&lt;option value="BGA0823" &gt;BGA0823 (新產品創意設計中心_綜合工程一館 8F)&lt;/option&gt;
&lt;option value="BGA0830" &gt;BGA0830 (電腦輔助繪圖室_綜合工程一館 8F)&lt;/option&gt;
&lt;option value="BGA0842" &gt;BGA0842 (機械元件設計實驗室_綜合工程一館 8F)&lt;/option&gt;
&lt;option value="BGA0901" &gt;BGA0901 (國際會議廳_綜合工程一館 9F)&lt;/option&gt;
&lt;option value="BGA0911" &gt;BGA0911 (機電實驗室_綜合工程一館 9F)&lt;/option&gt;</pre>
<p>則可以查詢各教室排課結果:</p>
<p>w1_classroom_local.py</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">import requests
import bs4
'''
# 假如使用 Python 3.9 執行則必須自行在程式碼中設定代理主機
import os
 
proxy = 'http://[2001:288:6004:17::69]:3128'
 
os.environ['http_proxy'] = proxy 
os.environ['HTTP_PROXY'] = proxy
os.environ['https_proxy'] = proxy
os.environ['HTTPS_PROXY'] = proxy
'''

'''
url:  'jclassroom_ajax.php',
data: { pselyr: pselyr, pselclssroom: pselclssroom },
'''
semester = '1092'
classroomno = 'BGA0810'
column = True

if semester == None:
    semester = '1092'
if classroomno == None:
    # BGA0810 電腦輔助設計室
    classroomno = 'BGA0810'
    
headers = {'X-Requested-With': 'XMLHttpRequest'}

url = 'https://qry.nfu.edu.tw/jclassroom_ajax.php'
post_var = {'pselyr': semester, 'pselclssroom': classroomno}

result = requests.post(url, data = post_var, headers = headers)

soup = bs4.BeautifulSoup(result.content, 'lxml')

# 先除掉所有 anchor
for a in soup.findAll('a'):
    a.replaceWithChildren()

# 根據輸出設定, 取出 class='tbcls' 的 table 資料
table = soup.find('table', {'class': 'tbcls'})

# 重建 table, 設定邊線為 1 pixel
output = "&lt;table border='1'&gt;"

for i in table.contents:
    # 利用 replace 復原  
    output += str(i).replace("&amp;amp;nbsp", " ")
output += "&lt;/table&gt;"
print(output)
</pre>
<h4>有關專題分組:</h4>
<p style="padding-left: 30px;"><span style="background-color: #ffff99;">請問我們打算如何解決 <a href="http://mde.tw/cd2021/content/Stage1.html" style="background-color: #ffff99;">http://mde.tw/cd2021/content/Stage1.html</a> 分組定組序與建立分組專題連結 html 的問題?</span></p>
<h4>延伸練習:</h4>
<ol>
<li><span style="background-color: #ffff99;">請各組修改上述程式碼, 直接將查詢結果存為 html, 並且直接呼叫 firefox 瀏覽器開啟所建立的超文件檔案.</span></li>
<li><span style="background-color: #ffff99;">請各組將上述兩則程式套入 Flask, 改寫成網際程式, 並分別在 Windows 10 與 Ubuntu 20.04 中執行.</span></li>
<li><span style="background-color: #ffff99;">請各組設法為程將上述程式改為 Flask based 後, 將程式部署在 Heroku 中執行.</span></li>
<li><span style="background-color: #ffff99;">請問上述的近端或網際程式架構, 是否可以應用在機械設計的某一個過程? (網際, AJAX, Heroku 部署).</span></li>
</ol>
<h4>額外處理:</h4>
<p style="padding-left: 30px;"><a href="https://forum.eng.nfu.edu.tw/t/topic/105/2">https://forum.eng.nfu.edu.tw/t/topic/105/2</a></p>
<p style="padding-left: 30px;">針對 CMSiMDE 無法正確對 config/content.htm 分頁時能夠列出建議事項, 協助用戶解決問題.</p>
<h4 style="padding-left: 30px;">問題:</h4>
<p style="padding-left: 60px;">CMSiMDE 動態網站如何進行分頁?</p>
<p style="padding-left: 60px;">CMSiMDE 的靜態網頁如何產生?</p>
<p style="padding-left: 60px;">為何網際內容管理系統要分動態與靜態網頁?</p>
<p style="padding-left: 60px;">CMSiMDE 的網站分頁架構源自 <a href="https://www.cmsimple.org/en/,">https://www.cmsimple.org/en/,</a> 其中一度使用 <a href="https://cherrypy.org/">https://cherrypy.org/</a>, 最後才改為現在的 <a href="https://github.com/pallets/flask">https://github.com/pallets/flask</a>.</p>
<p style="padding-left: 60px;">CMSiMDE 自 2013 年底開發至今, 可能需要重新改寫了:-) anybody??</p>
<p style="padding-left: 30px;">延伸練習:</p>
<p style="padding-left: 60px;"><span style="background-color: #ffff99;">請各組研究一下 <a href="https://github.com/mdecourse/cmsimde" style="background-color: #ffff99;">https://github.com/mdecourse/cmsimde</a> 中的分頁程式, 並嘗試編寫一個能夠協助使用者在無法正確編輯動態網頁時進行 Debug 用.</span></p>
<p>在處理特定目錄中檔案內容字串置換時, 可以利用下列程式碼:</p>
<p>walk_in_dir_and_replace_string.py</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">import os
findText = """content to remove"""
for dname, dirs, files in os.walk("path_name"):
    for fname in files:
        if fname[-5:] == ".html":
            print(fname)
            fpath = os.path.join(dname, fname)
            with open(fpath, encoding="utf-8") as f:
                s = f.read()
            s = s.replace(findText, "")
            with open(fpath, "w", encoding="utf-8") as f:
                f.write(s)</pre>
<p></p><br />分組專題 << <a href='分組專題.html'>Previous</a> <a href='Topic 1.html'>Next</a> >> Topic 1</div>
        
    <!-- footer -->
      <div class="container">
        <div class="row pt-3 mx-auto">
            <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank" >Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
        </div>
      </div>
    <!-- for footer -->
    
        </div> <!-- for site wrap -->
            <!-- <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script> -->
            <script src="../cmsimde/static/chimper/js/jquery-migrate-3.0.1.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery-ui.js"></script>
            <script src="../cmsimde/static/chimper/js/popper.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap.min.js"></script>
            <script src="../cmsimde/static/chimper/js/owl.carousel.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.stellar.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.countdown.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.magnific-popup.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap-datepicker.min.js"></script>
            <script src="../cmsimde/static/chimper/js/aos.js"></script>
            <!--
            <script src="../cmsimde/static/chimper/js/typed.js"></script>
                    <script>
                    var typed = new Typed('.typed-words', {
                    strings: ["Web Apps"," WordPress"," Mobile Apps"],
                    typeSpeed: 80,
                    backSpeed: 80,
                    backDelay: 4000,
                    startDelay: 1000,
                    loop: true,
                    showCursor: true
                    });
                    </script>
            -->
            <script src="../cmsimde/static/chimper/js/main.js"></script>
        
<!-- 啟用 LaTeX equations 編輯 -->
  <!-- <script>
  MathJax = {
    tex: {inlineMath: [['$', '$'], ['\(', '\)']]}
  };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>-->
    </body></html>
        